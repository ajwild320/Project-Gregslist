from models import db, user

class UserRepository:
    
    
    def add_user(self, user_id, email, username, new_pass):
        new_user = user(user_id, email, username, new_pass)
        db.session.add(new_user)
        db.session.commit()
        return new_user

    def get_user_by_id(self, user_id):
        return db.session.get(user_id)

    def change_email(self, user_id, email, old_user, old_pass):
        if self.check_info(old_user, old_pass):
            user.query.get(user_id).email = email

    def change_user(self, user_id, new_user, old_user, old_pass):
        if self.check_info(old_user, old_pass) and self.validate_user(new_user):
            user.query.get(user_id).username = new_user

    def change_pass(self, user_id, input_pass, old_user, old_pass):
        if self.check_info(old_user, old_pass):
            user.query.get(user_id).user_password = input_pass

    def validate_user(self, username):
        return user.query.get(username) == None
    
    def delete_user(self, user_id):
        db.session.delete(user.query.get(user_id))
        db.session.commit()

user_repository_singleton = UserRepository() 